; /usr/local/etc/php/conf.d/zz-opcache.ini

; Ensure OPcache is enabled (it usually is by default, but this confirms it)
opcache.enable=1
; Enable OPcache for CLI, which speeds up Artisan commands
opcache.enable_cli=1

; CRUCIAL FOR PRODUCTION: Don't check file timestamps after caching (fastest mode)
; WARNING: Requires PHP-FPM restart or cache clearing on code deploy!
opcache.validate_timestamps=0

; Allocate 256MB of shared memory (adjust based on app size)
opcache.memory_consumption=256

; Max number of files to cache (Laravel needs a high number)
opcache.max_accelerated_files=20000

; Storage for interned strings (improves performance in large frameworks like Laravel)
opcache.interned_strings_buffer=16

; Use a fast shutdown mechanism
opcache.fast_shutdown=1

; Only one chance to restart OPcache when the memory is full
opcache.max_wasted_percentage=5

;opcache.preload=/app/preload.php
opcache.preload_user=www-data